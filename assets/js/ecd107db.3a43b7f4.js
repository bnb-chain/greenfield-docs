"use strict";(self.webpackChunkgreenfield_docs=self.webpackChunkgreenfield_docs||[]).push([[70],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=i,g=d["".concat(c,".").concat(m)]||d[m]||p[m]||o;return n?a.createElement(g,r(r({ref:t},u),{},{components:n})):a.createElement(g,r({ref:t},u))}));function g(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=m;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[d]="string"==typeof e?e:i,r[1]=l;for(var s=2;s<o;s++)r[s]=n[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},94246:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var a=n(87462),i=(n(67294),n(3905));const o={title:"Glacier Decentralized VectorDB",description:"How to manage vector data on top of BNB Greenfield.",keywords:["BNB Greenfield","Glacier","VectorDB"],order:3},r="How to Manage Vector Data Utilizing Glacier VectorDB",l={unversionedId:"tutorials/ai/glacier-db-tutorial",id:"tutorials/ai/glacier-db-tutorial",title:"Glacier Decentralized VectorDB",description:"How to manage vector data on top of BNB Greenfield.",source:"@site/docs/tutorials/ai/glacier-db-tutorial.md",sourceDirName:"tutorials/ai",slug:"/tutorials/ai/glacier-db-tutorial",permalink:"/greenfield-docs/docs/tutorials/ai/glacier-db-tutorial",draft:!1,editUrl:"https://github.com/bnb-chain/greenfield-docs/blob/main/docs/tutorials/ai/glacier-db-tutorial.md",tags:[],version:"current",frontMatter:{title:"Glacier Decentralized VectorDB",description:"How to manage vector data on top of BNB Greenfield.",keywords:["BNB Greenfield","Glacier","VectorDB"],order:3},sidebar:"tutorialsSidebar",previous:{title:"Greenfield for Hugging Face",permalink:"/greenfield-docs/docs/tutorials/ai/hugging-face-intro"}},c={},s=[{value:"Background",id:"background",level:2},{value:"What is Glacier DeVector?",id:"what-is-glacier-devector",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"QuickStart",id:"quickstart",level:2},{value:"Create a GlacierClient",id:"create-a-glacierclient",level:3},{value:"Create DeVector collection",id:"create-devector-collection",level:3},{value:"Load Embedding Documents",id:"load-embedding-documents",level:3},{value:"Write a chatbot",id:"write-a-chatbot",level:3},{value:"Build Prompt",id:"build-prompt",level:3},{value:"Chat with documents",id:"chat-with-documents",level:3}],u={toc:s},d="wrapper";function p(e){let{components:t,...o}=e;return(0,i.kt)(d,(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"how-to-manage-vector-data-utilizing-glacier-vectordb"},"How to Manage Vector Data Utilizing Glacier VectorDB"),(0,i.kt)("h2",{id:"background"},"Background"),(0,i.kt)("p",null,"Welcome to this tutorial focused on leveraging Greenfield's capabilities for AI and machine learning, alongside interacting with ",(0,i.kt)("a",{parentName:"p",href:"https://www.glacier.io/ai"},"Glacier DeVector Database"),". In this comprehensive guide, we delve into an innovative technique: integrating OpenAI's GPT models with Greenfield's blockchain data through ",(0,i.kt)("inlineCode",{parentName:"p"},"Retrieval-Augmented Generation (RAG)"),". This approach is particularly crucial for handling recent or specialized data, which traditional models might struggle with."),(0,i.kt)("p",null,"Our journey will include utilizing Glacier DeVector for efficient data management and query processing. This ensures that our text generation is not only smooth and context-aware but also enriched with the most current real-time data. By combining these cutting-edge technologies, we empower our models to generate content that is not only highly accurate but also exceptionally relevant and up-to-date."),(0,i.kt)("h2",{id:"what-is-glacier-devector"},"What is Glacier DeVector?"),(0,i.kt)("p",null,"Glacier DeVector is a decentralized vector database built on top of Greenfield blockchain, seamlessly integrated into the AI ecosystem."),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(67259).Z,width:"2000",height:"893"})),(0,i.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Glacier DeVector Endpoint: ",(0,i.kt)("a",{parentName:"li",href:"https://greenfield.onebitdev.com/glacier-gateway-vector/"},"https://greenfield.onebitdev.com/glacier-gateway-vector/")),(0,i.kt)("li",{parentName:"ul"},"Huggingface API Token: ",(0,i.kt)("a",{parentName:"li",href:"https://huggingface.co/docs/api-inference/quicktour"},"https://huggingface.co/docs/api-inference/quicktour")),(0,i.kt)("li",{parentName:"ul"},"OpenAI APIKey: ",(0,i.kt)("a",{parentName:"li",href:"https://platform.openai.com/account/api-keys"},"https://platform.openai.com/account/api-keys")),(0,i.kt)("li",{parentName:"ul"},"Glacier SDK NPM: @glacier-network/client"),(0,i.kt)("li",{parentName:"ul"},"Demo wallet: create a new one that only for test purpose!")),(0,i.kt)("h2",{id:"quickstart"},"QuickStart"),(0,i.kt)("p",null,"In this quickstart, we store a dataset related to programing-lang and chat with the documents."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/Glacier-Labs/devector-demo"},"Demo Project"))),(0,i.kt)("h3",{id:"create-a-glacierclient"},"Create a GlacierClient"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const privateKey = `<your-wallet-privateKey>`;\nconst endpoint = 'https://greenfield.onebitdev.com/glacier-gateway-vector/'\nconst client = new GlacierClient(endpoint, {\n  privateKey,\n});\n")),(0,i.kt)("h3",{id:"create-devector-collection"},"Create DeVector collection"),(0,i.kt)("p",null,"All vector features start from here. We just simply define the schema of a collection to enable the vector feature."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'const schema = {\n  title: "programming-lang",\n  type: "object",\n  properties: {\n    name: {\n      type: "string",\n    },\n    nameEmbedding: {\n      type: "string",\n      vectorIndexOption: {\n        "type": "knnVector",\n        "dimensions": 384,\n        "similarity": "euclidean",\n      },\n    },\n    link: {\n      type: "string",\n    },\n    type: {\n      type: "string",\n    }\n  }\n}\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"nameEmbedding")," is a vector field that support vector query for ",(0,i.kt)("inlineCode",{parentName:"li"},"name"),". We use the ",(0,i.kt)("inlineCode",{parentName:"li"},"VectorIndexOption")," describe the vector feature, and the Embedding suffix is not necessary but it's good to use Embedding to name the field."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"VectorIndexOption"),": define vector options"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Type"),": Value must be knnVector."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Dimensions"),": Number of vector dimensions, This value can't be greater than 2048. Here we use 384 dimensions that transform by the embedding model all-MiniLM-L6-v2"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Similarity"),": Vector similarity function to use to search for top K-nearest neighbors. Value can be one of the following: euclidean, cosine, dotProduct")),(0,i.kt)("h3",{id:"load-embedding-documents"},"Load Embedding Documents"),(0,i.kt)("p",null,"We use the Huggingface API to embedding documents, any other embedding tool can be used well.\nModel: all-MiniLM-L6-v2\nAPI: ",(0,i.kt)("a",{parentName:"p",href:"https://api-inference.huggingface.co/pipeline/feature-extraction/sentence-transformers/all-MiniLM-L6-v2"},"https://api-inference.huggingface.co/pipeline/feature-extraction/sentence-transformers/all-MiniLM-L6-v2")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"let doc = {\n    'link': '<http://en.wikipedia.org/wiki/A-0_System>',\n    'type': 'ComputerLanguage',\n    'name': 'A-0 System',\n    'nameEmbedding': await getEmbeddingFromHF('A-0 System'),\n}\nlet coll = client.namespace(namespace).dataset(dataset).collection(collection)\nlet resp = await coll.insertOne(doc)\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"async function getEmbeddingFromHF(input) {\n const embedding_url = \"<https://api-inference.huggingface.co/pipeline/feature-extraction/sentence-transformers/all-MiniLM-L6-v2>\"\n  let response = await axios.post(embedding_url, {\n    inputs: input,\n  }, {\n    headers: {\n      'Authorization': `Bearer ${hf_token}`,\n      'Content-Type': 'application/json'\n    }\n  });\n  if (response.status === 200) {\n    return response.data;\n  } else {\n    throw new Error(`Failed to get embedding. Status code: ${response.status}`);\n  }\n}\n\n")),(0,i.kt)("h3",{id:"write-a-chatbot"},"Write a chatbot"),(0,i.kt)("p",null,"Before we chat with the documents, we should write a chatbot for your data domain."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// Chat With Documents\nlet chatDocs = async (namespace, dataset, collection, input) => {\n  const docs = await search(namespace, dataset, collection, input)\n  if (docs.length === 0) {\n    console.log(`I'm not sure about your question!`)\n    return\n  }\n  const contexts = docs.map(item => `language: ${item.name}, wikipedia link: ${item.link}` )\n  const messages = buildPrompt(input, contexts)\n  const result = await getChatCompletions(messages)\n  console.log(`Your question: ${input}`)\n  console.log(`Chat response: ${result}`)\n}\n\n// Get Chat Response\nasync function getChatCompletions(messages) {\n  // Define the OpenAI API url and key.\n  const url = 'https://api.openai.com/v1/chat/completions';\n\n  // Call OpenAI API to get the embeddings.\n  let response = await axios.post(url, {\n    model: \"gpt-3.5-turbo\",\n    messages: messages,\n  }, {\n    headers: {\n      'Authorization': `Bearer ${openai_key}`,\n      'Content-Type': 'application/json'\n    }\n  });\n\n  if (response.status === 200) {\n    return response.data.choices[0].message.content;\n  } else {\n    throw new Error(`Failed to get chat completion. Status code: ${response.status}`);\n  }\n}\n")),(0,i.kt)("h3",{id:"build-prompt"},"Build Prompt"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'function buildPrompt(query, context) {\n  const system = {\n    "role": "system",\n    "content": "I am going to ask you a question, which I would like you to answer" +\n    "based only on the provided context, and not any other information." +\n    "If there is not enough information in the context to answer the question," +\n    "say \\"I am not sure\\", then try to make a guess." +\n    "Break your answer up into nicely readable paragraphs."\n  };\n  const user = {\n    "role": "user",\n    "content": "The question is " + query + ". Here is all the context you have:" +\n    context.join(" ")\n  };\n  return [system, user]\n}\n')),(0,i.kt)("h3",{id:"chat-with-documents"},"Chat with documents"),(0,i.kt)("p",null,"Now, we can chat with the documents."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"node vector-demo.js\n")),(0,i.kt)("p",null,"chat 'which language is about the system, show me the wikipedia link?'"),(0,i.kt)("p",null,"Response"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Your question: which language is about the system, show me the wikipedia link?\nChat response: Based on the provided context, the language that is about the system is the A-0 System. The Wikipedia link for the A-0 System is <http://en.wikipedia.org/wiki/A-0_System>.\n")),(0,i.kt)("h1",{id:"conclusion"},"Conclusion"),(0,i.kt)("p",null,"In conclusion, this tutorial has demonstrated the powerful synergy between Greenfield's blockchain technology and OpenAI's GPT models, enhanced through Retrieval-Augmented Generation (RAG). By integrating these technologies with Glacier DeVector's efficient data management system, we have unlocked new potentials in AI and machine learning, particularly in generating up-to-date, relevant, and accurate content. We hope this journey has been enlightening and that it inspires you to explore further into the exciting world of AI and blockchain technology."),(0,i.kt)("p",null,"Build AI-powered application utilizing Glacier VectorDB on Greenfield:\nPlease contact ",(0,i.kt)("a",{parentName:"p",href:"mailto:info@glacier.io"},"info@glacier.io")))}p.isMDXComponent=!0},67259:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/glacierdb-06cd644175c157e5994cf4f2fece915a.png"}}]);