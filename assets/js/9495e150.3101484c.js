"use strict";(self.webpackChunkgreenfield_docs=self.webpackChunkgreenfield_docs||[]).push([[4728],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),c=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,g=d["".concat(s,".").concat(m)]||d[m]||u[m]||o;return n?r.createElement(g,i(i({ref:t},p),{},{components:n})):r.createElement(g,i({ref:t},p))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:a,i[1]=l;for(var c=2;c<o;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},85162:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(67294),a=n(86010);const o={tabItem:"tabItem_Ymn6"};function i(e){let{children:t,hidden:n,className:i}=e;return r.createElement("div",{role:"tabpanel",className:(0,a.Z)(o.tabItem,i),hidden:n},t)}},65488:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(87462),a=n(67294),o=n(86010),i=n(72389),l=n(67392),s=n(7094),c=n(12466);const p={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function d(e){const{lazy:t,block:n,defaultValue:i,values:d,groupId:u,className:m}=e,g=a.Children.map(e.children,(e=>{if((0,a.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),f=d??g.map((e=>{let{props:{value:t,label:n,attributes:r}}=e;return{value:t,label:n,attributes:r}})),h=(0,l.l)(f,((e,t)=>e.value===t.value));if(h.length>0)throw new Error(`Docusaurus error: Duplicate values "${h.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const k=null===i?i:i??g.find((e=>e.props.default))?.props.value??g[0].props.value;if(null!==k&&!f.some((e=>e.value===k)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${k}" but none of its children has the corresponding value. Available values are: ${f.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:v,setTabGroupChoices:b}=(0,s.U)(),[y,w]=(0,a.useState)(k),x=[],{blockElementScrollPositionUntilNextRender:N}=(0,c.o5)();if(null!=u){const e=v[u];null!=e&&e!==y&&f.some((t=>t.value===e))&&w(e)}const S=e=>{const t=e.currentTarget,n=x.indexOf(t),r=f[n].value;r!==y&&(N(t),w(r),null!=u&&b(u,String(r)))},P=e=>{let t=null;switch(e.key){case"Enter":S(e);break;case"ArrowRight":{const n=x.indexOf(e.currentTarget)+1;t=x[n]??x[0];break}case"ArrowLeft":{const n=x.indexOf(e.currentTarget)-1;t=x[n]??x[x.length-1];break}}t?.focus()};return a.createElement("div",{className:(0,o.Z)("tabs-container",p.tabList)},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},m)},f.map((e=>{let{value:t,label:n,attributes:i}=e;return a.createElement("li",(0,r.Z)({role:"tab",tabIndex:y===t?0:-1,"aria-selected":y===t,key:t,ref:e=>x.push(e),onKeyDown:P,onClick:S},i,{className:(0,o.Z)("tabs__item",p.tabItem,i?.className,{"tabs__item--active":y===t})}),n??t)}))),t?(0,a.cloneElement)(g.filter((e=>e.props.value===y))[0],{className:"margin-top--md"}):a.createElement("div",{className:"margin-top--md"},g.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==y})))))}function u(e){const t=(0,i.Z)();return a.createElement(d,(0,r.Z)({key:String(t)},e))}},57039:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>g,frontMatter:()=>l,metadata:()=>c,toc:()=>d});var r=n(87462),a=(n(67294),n(3905)),o=n(65488),i=n(85162);const l={title:"Exit Greenfield SP Network"},s=void 0,c={unversionedId:"guide/storage-provider/run-book/exit-SP-network",id:"guide/storage-provider/run-book/exit-SP-network",title:"Exit Greenfield SP Network",description:"This guide provides step-by-step instructions for SPs to exit the Greenfield NextWork on the Mainnet or Testnet, along with",source:"@site/docs/guide/storage-provider/run-book/exit-SP-network.md",sourceDirName:"guide/storage-provider/run-book",slug:"/guide/storage-provider/run-book/exit-SP-network",permalink:"/greenfield-docs/docs/guide/storage-provider/run-book/exit-SP-network",draft:!1,editUrl:"https://github.com/bnb-chain/greenfield-docs/blob/main/docs/guide/storage-provider/run-book/exit-SP-network.md",tags:[],version:"current",frontMatter:{title:"Exit Greenfield SP Network"},sidebar:"guideSidebar",previous:{title:"Join Greenfield SP Network",permalink:"/greenfield-docs/docs/guide/storage-provider/run-book/join-SP-network"},next:{title:"How to deploy Piece Store",permalink:"/greenfield-docs/docs/guide/storage-provider/run-book/piece-store"}},p={},d=[{value:"How to exit Greenfield network",id:"how-to-exit-greenfield-network",level:2},{value:"1. Declare the exit",id:"1-declare-the-exit",level:3},{value:"2. Data recovery",id:"2-data-recovery",level:3},{value:"2.1 ReserveSwapIn",id:"21-reserveswapin",level:4},{value:"2.2 Data Recovery",id:"22-data-recovery",level:4},{value:"2.3 CompleteSwapIn",id:"23-completeswapin",level:4}],u={toc:d},m="wrapper";function g(e){let{components:t,...n}=e;return(0,a.kt)(m,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"This guide provides step-by-step instructions for SPs to exit the Greenfield NextWork on the Mainnet or Testnet, along with\nthe necessary actions to be performed by both the exiting SP and the successor SP(s)."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#how-to-exit-greenfield-network"},"How to exit Greenfield network"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#1-declare-the-exit"},"1. Declare The Exit")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#2-data-recovery"},"2. Data Recovery")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#3-finalize-the-exit"},"3. Finalize The Exit"))))),(0,a.kt)("h2",{id:"how-to-exit-greenfield-network"},"How to exit Greenfield network"),(0,a.kt)("p",null,"When an SP decides to exit the Greenfield network, there are three main steps to go through, involving both the exiting SP and other SPs in the network:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Declare the exit"),(0,a.kt)("li",{parentName:"ol"},"Data recovery by successor SP(s)"),(0,a.kt)("li",{parentName:"ol"},"Finalize the exit")),(0,a.kt)("h3",{id:"1-declare-the-exit"},"1. Declare the exit"),(0,a.kt)("p",null,"The exiting SP needs to initiate an ",(0,a.kt)("inlineCode",{parentName:"p"},"StorageProviderExit")," transaction to Greenfield blockchain, which will turn its status to ",(0,a.kt)("inlineCode",{parentName:"p"},"STATUS_GRACEFUL_EXITING"),"."),(0,a.kt)("p",null,"To exit the network, you can use the following commands based on the desired network:"),(0,a.kt)(o.Z,{defaultValue:"mainnet",values:[{label:"Mainnet",value:"mainnet"},{label:"Testnet",value:"testnet"}],mdxType:"Tabs"},(0,a.kt)(i.Z,{value:"mainnet",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'rpcAddr = "https://greenfield-chain.bnbchain.org:443"\nchainId = "greenfield_1017-1"\n'))),(0,a.kt)(i.Z,{value:"testnet",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'rpcAddr = "https://gnfd-testnet-fullnode-tendermint-us.bnbchain.org:443"\nchainId = "greenfield_5600-1"\n')))),(0,a.kt)("p",null,"Command for storage provider to exit:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"gnfd-sp spExit [command options] [arguments...]\n")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"./build/bin/gnfd-sp spExit --config ./config.toml\n")),(0,a.kt)("h3",{id:"2-data-recovery"},"2. Data recovery"),(0,a.kt)("p",null,"For SPs interested in becoming successors, you need to perform the following data recovery steps:"),(0,a.kt)("h4",{id:"21-reserveswapin"},"2.1 ReserveSwapIn"),(0,a.kt)("p",null,"The perspective successor SP needs to determine Global Virtual group(GVG) and Global Virtual Group Family(VGF) that exiting SP has,\nThis information can be obtained from ",(0,a.kt)("a",{parentName:"p",href:"https://greenfieldscan-mainnet.fe.nodereal.cc/account/0x2901fddef924f077ec6811a4a6a1cb0f13858e8f?tab=gvg"},"GreenfieldScan")," or by using the provided CLI."),(0,a.kt)("p",null,"Usage:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# List the GVG that the exit SP act as secondary SP\n./gnfd-sp query-gvg-by-sp [command options] [arguments...]\n# List the GVG Family that the exit SP act as primary SP\n./gnfd-sp query-vgf-by-sp [command options] [arguments...]\n")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# List the GVG that the exit SP(id=1) act as secondary SP\n./gnfd-sp query-gvg-by-sp --config ./config.toml -sp 1\n# List the GVG Family that the exit SPP(id=1) act as primary SP\n./gnfd-sp query-vgf-by-sp --config ./config.toml -sp 1\n")),(0,a.kt)("p",null,"Once the successor SP has obtained the necessary information, it needs to reserve the position in the exit SP's GVG Family or GVG."),(0,a.kt)("p",null,"Usage:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# Reserve the exit SP's position in GVG family or GVG\n./gnfd-sp swapIn [command options] [arguments...]\n")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# Reserve the exit SP's(id=1) position in GVG family(id=1)\n./gnfd-sp swapIn --config ./config.toml -f 1 -sp 1\n# Reserve the exit SP's(id=1) position in GVG(id=1)\n./gnfd-sp swapIn --config ./config.toml --gid 1 -sp 1\n")),(0,a.kt)("h4",{id:"22-data-recovery"},"2.2 Data Recovery"),(0,a.kt)("p",null,"The data recovery process is triggered by the successor SP using the following commands:"),(0,a.kt)("p",null,"Usage:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"./gnfd-sp recover-vgf [command options] [arguments...]\n./gnfd-sp recover-gvg [command options] [arguments...]\n")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# To recover the exit SP's data in the VGF(id=1) as a primary SP:\n./gnfd-sp recover-vgf --config /config/config.toml -f 1\n# To recover the exit SP's data in the GVG(id=1) as a secondary SP:\n./gnfd-sp swapIn --config ./config.toml --gid 1\n")),(0,a.kt)("p",null,"Once the recovery job is triggered, it will run in the background in the SP Manager module. The progress can be queried using the following command:"),(0,a.kt)("p",null,"Usage:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"./gnfd-sp query-recover-p [command options] [arguments...]\n")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# Query the GVG family(id=1) recover progress \n./gnfd-sp recover-vgf --config /config/config.toml -f 1\n# Query the GVG(id=1) recover progress\n./gnfd-sp recover-vgf --config /config/config.toml --gid 1\n")),(0,a.kt)("h4",{id:"23-completeswapin"},"2.3 CompleteSwapIn"),(0,a.kt)("p",null,"Upon completion of the data recovery process and successful verification, the successor SP needs to send a ",(0,a.kt)("inlineCode",{parentName:"p"},"CompleteSwapIn"),"\ntransaction to the Greenfield blockchain, it will be automatically conducted before the recover process concludes,\nThis will finalize the recovery process and allow the successor SP to take over the position in the GVG Family or GVG."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"It is crucial to note that under no circumstances should the ",(0,a.kt)("inlineCode",{parentName:"p"},"CompleteSwapIn")," be triggered manually if the successor SP\nhas not completed the data recovery process but acknowledges it. Doing so may result in data availability challenges and\npotential loss of funds. "),(0,a.kt)("h3",{parentName:"admonition",id:"3-finalize-the-exit"},"3. Finalize the Exit"),(0,a.kt)("p",{parentName:"admonition"},"Once the successor SP has completed the data recovery process and taken over the position in the GVG Family or GVG, by checking the\nGVG statistic of exitting SP, confirm that there are no more GVGs associated with it. Anyone in Greenfield network can\nsend a ",(0,a.kt)("inlineCode",{parentName:"p"},"CompleteStorageProviderExit")," transaction to the Greenfield blockchain to finalize its exit from the network.\nBelow shows the CLI triggered by exiting SP itself."),(0,a.kt)("p",{parentName:"admonition"},"Usage:"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"./gnfd-sp completeSpExit [command options] [arguments...]\n")),(0,a.kt)("p",{parentName:"admonition"},"Example:"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"./gnfd-sp completeSpExit --config /config/config.toml\n"))))}g.isMDXComponent=!0}}]);