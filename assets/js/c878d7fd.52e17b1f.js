"use strict";(self.webpackChunkgreenfield_docs=self.webpackChunkgreenfield_docs||[]).push([[4647],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>m});var o=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},i=Object.keys(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=o.createContext({}),p=function(e){var t=o.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},c=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},g="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),g=p(r),u=n,m=g["".concat(l,".").concat(u)]||g[u]||d[u]||i;return r?o.createElement(m,a(a({ref:t},c),{},{components:r})):o.createElement(m,a({ref:t},c))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,a=new Array(i);a[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[g]="string"==typeof e?e:n,a[1]=s;for(var p=2;p<i;p++)a[p]=r[p];return o.createElement.apply(null,a)}return o.createElement.apply(null,r)}u.displayName="MDXCreateElement"},91046:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var o=r(87462),n=(r(67294),r(3905));const i={title:"Signer"},a="Signer",s={unversionedId:"guide/storage-provider/modules/signer",id:"guide/storage-provider/modules/signer",title:"Signer",description:"Signer uses the SP's private keys to sign the message, the messages to form a transaction and sign the transaction to broadcast it to Greenfield BlockChain, or the messages exchanged between SPs.",source:"@site/docs/guide/storage-provider/modules/signer.md",sourceDirName:"guide/storage-provider/modules",slug:"/guide/storage-provider/modules/signer",permalink:"/greenfield-docs/docs/guide/storage-provider/modules/signer",draft:!1,editUrl:"https://github.com/bnb-chain/greenfield-docs/blob/main/docs/guide/storage-provider/modules/signer.md",tags:[],version:"current",frontMatter:{title:"Signer"},sidebar:"guideSidebar",previous:{title:"Downloader",permalink:"/greenfield-docs/docs/guide/storage-provider/modules/downloader"},next:{title:"Manager",permalink:"/greenfield-docs/docs/guide/storage-provider/modules/manager"}},l={},p=[{value:"SignReplicatePieceApproval",id:"signreplicatepieceapproval",level:2},{value:"SignReceivePieceTask",id:"signreceivepiecetask",level:2},{value:"SignP2PPingMsg",id:"signp2ppingmsg",level:2},{value:"SignP2PPongMsg",id:"signp2ppongmsg",level:2},{value:"SealObject",id:"sealobject",level:2},{value:"RejectUnSealObject",id:"rejectunsealobject",level:2},{value:"DiscontinueBucket",id:"discontinuebucket",level:2},{value:"CreateGlobalVirtualGroup",id:"createglobalvirtualgroup",level:2},{value:"CompleteMigrateBucket",id:"completemigratebucket",level:2},{value:"UpdateSPPrice",id:"updatespprice",level:2},{value:"SwapOut",id:"swapout",level:2},{value:"CompleteSwapOut",id:"completeswapout",level:2},{value:"SPExit",id:"spexit",level:2},{value:"CompleteSPExit",id:"completespexit",level:2},{value:"GfSp Framework Signer Code",id:"gfsp-framework-signer-code",level:2}],c={toc:p},g="wrapper";function d(e){let{components:t,...r}=e;return(0,n.kt)(g,(0,o.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"signer"},"Signer"),(0,n.kt)("p",null,"Signer uses the SP's private keys to sign the message, the messages to form a transaction and sign the transaction to broadcast it to Greenfield BlockChain, or the messages exchanged between SPs."),(0,n.kt)("p",null,"Signer is an abstract interface to handle the signature of SP and on greenfield chain operator. It holds all private keys of one SP. Considering the SP account's sequence number, it must be a singleton."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-go"},"type Signer interface {\n    Modular\n    // SignCreateBucketApproval signs the MsgCreateBucket for asking create bucket approval.\n    SignCreateBucketApproval(ctx context.Context, bucket *storagetypes.MsgCreateBucket) ([]byte, error)\n    // SignMigrateBucketApproval signs the MsgMigrateBucket for asking migrate bucket approval\n    SignMigrateBucketApproval(ctx context.Context, bucket *storagetypes.MsgMigrateBucket) ([]byte, error)\n    // SignCreateObjectApproval signs the MsgCreateObject for asking create object approval.\n    SignCreateObjectApproval(ctx context.Context, task *storagetypes.MsgCreateObject) ([]byte, error)\n    // SignReplicatePieceApproval signs the ApprovalReplicatePieceTask for asking replicate pieces to secondary SPs.\n    SignReplicatePieceApproval(ctx context.Context, task task.ApprovalReplicatePieceTask) ([]byte, error)\n    // SignReceivePieceTask signs the ReceivePieceTask for replicating pieces data between SPs.\n    SignReceivePieceTask(ctx context.Context, task task.ReceivePieceTask) ([]byte, error)\n    // SignSecondarySealBls signs the secondary bls for sealing object.\n    SignSecondarySealBls(ctx context.Context, objectID uint64, gvgId uint32, hash [][]byte) ([]byte, error)\n    // SignRecoveryPieceTask signs the RecoveryPieceTask for recovering piece data\n    SignRecoveryPieceTask(ctx context.Context, task task.RecoveryPieceTask) ([]byte, error)\n    // SignP2PPingMsg signs the ping msg for p2p node probing.\n    SignP2PPingMsg(ctx context.Context, ping *gfspp2p.GfSpPing) ([]byte, error)\n    // SignP2PPongMsg signs the pong msg for p2p to response ping msg.\n    SignP2PPongMsg(ctx context.Context, pong *gfspp2p.GfSpPong) ([]byte, error)\n    // SealObject signs the MsgSealObject and broadcast the tx to greenfield.\n    SealObject(ctx context.Context, object *storagetypes.MsgSealObject) (string, error)\n    // RejectUnSealObject signs the MsgRejectSealObject and broadcast the tx to greenfield.\n    RejectUnSealObject(ctx context.Context, object *storagetypes.MsgRejectSealObject) (string, error)\n    // DiscontinueBucket signs the MsgDiscontinueBucket and broadcast the tx to greenfield.\n    DiscontinueBucket(ctx context.Context, bucket *storagetypes.MsgDiscontinueBucket) (string, error)\n    // CreateGlobalVirtualGroup signs the MsgCreateGlobalVirtualGroup and broadcast the tx to greenfield.\n    CreateGlobalVirtualGroup(ctx context.Context, gvg *virtualgrouptypes.MsgCreateGlobalVirtualGroup) error\n    // SignMigratePiece signs the GfSpMigratePieceTask for migrating piece\n    SignMigratePiece(ctx context.Context, task *gfsptask.GfSpMigratePieceTask) ([]byte, error)\n    // CompleteMigrateBucket signs the MsgCompleteMigrateBucket and broadcast the tx to greenfield.\n    CompleteMigrateBucket(ctx context.Context, migrateBucket *storagetypes.MsgCompleteMigrateBucket) (string, error)\n    // SignSecondarySPMigrationBucket signs secondary sp bls for bucket migration\n    SignSecondarySPMigrationBucket(ctx context.Context, signDoc *storagetypes.SecondarySpMigrationBucketSignDoc) ([]byte, error)\n    // SwapOut signs the MsgSwapOut and broadcast the tx to greenfield.\n    SwapOut(ctx context.Context, swapOut *virtualgrouptypes.MsgSwapOut) (string, error)\n    // SignSwapOut signs the MsgSwapOut for asking swap out approval.\n    SignSwapOut(ctx context.Context, swapOut *virtualgrouptypes.MsgSwapOut) ([]byte, error)\n    // CompleteSwapOut signs the MsgCompleteSwapOut and broadcast the tx to greenfield.\n    CompleteSwapOut(ctx context.Context, completeSwapOut *virtualgrouptypes.MsgCompleteSwapOut) (string, error)\n    // SPExit signs the MsgStorageProviderExit and broadcast the tx to greenfield.\n    SPExit(ctx context.Context, spExit *virtualgrouptypes.MsgStorageProviderExit) (string, error)\n    // CompleteSPExit signs the MsgCompleteStorageProviderExit and broadcast the tx to greenfield.\n    CompleteSPExit(ctx context.Context, completeSPExit *virtualgrouptypes.MsgCompleteStorageProviderExit) (string, error)\n    // UpdateSPPrice signs the MsgUpdateSpStoragePrice and  broadcast the tx to greenfield.\n    UpdateSPPrice(ctx context.Context, price *sptypes.MsgUpdateSpStoragePrice) (string, error)\n}\n")),(0,n.kt)("p",null,"Signer interface inherits ",(0,n.kt)("a",{parentName:"p",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/lifecycle_modular#modular-interface"},"Modular interface"),", so Signer module can be managed by lifecycle and resource manager."),(0,n.kt)("p",null,"In terms of the functions provided by Signer module, there are ten methods. You can rewrite these methods to meet your own requirements."),(0,n.kt)("h2",{id:"signreplicatepieceapproval"},"SignReplicatePieceApproval"),(0,n.kt)("p",null,"The second params of SignReplicatePieceApproval is a task interface, the corresponding interface definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/task#approvalreplicatepiecetask"},"ApprovalReplicatePieceTask"))),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#gfspreplicatepieceapprovaltask-proto"},"GfSpReplicatePieceApprovalTask"))),(0,n.kt)("h2",{id:"signreceivepiecetask"},"SignReceivePieceTask"),(0,n.kt)("p",null,"The second params of SignReceivePieceTask is a task interface, the corresponding interface definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/task#approvalreplicatepiecetask"},"ReceivePieceTask"))),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#gfspreceivepiecetask-proto"},"GfSpReceivePieceTask"))),(0,n.kt)("h2",{id:"signp2ppingmsg"},"SignP2PPingMsg"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#gfspping-proto"},"GfSpPing"))),(0,n.kt)("h2",{id:"signp2ppongmsg"},"SignP2PPongMsg"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#gfsppong-proto"},"GfSpPong"))),(0,n.kt)("h2",{id:"sealobject"},"SealObject"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#msgsealobject"},"MsgSealObject"))),(0,n.kt)("h2",{id:"rejectunsealobject"},"RejectUnSealObject"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#msgrejectsealobject-proto"},"MsgRejectSealObject"))),(0,n.kt)("h2",{id:"discontinuebucket"},"DiscontinueBucket"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#msgdiscontinuebucket"},"MsgDiscontinueBucket"))),(0,n.kt)("h2",{id:"createglobalvirtualgroup"},"CreateGlobalVirtualGroup"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#msgcreateglobalvirtualgroup"},"MsgCreateGlobalVirtualGroup"))),(0,n.kt)("h2",{id:"completemigratebucket"},"CompleteMigrateBucket"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#msgcompletemigratebucket"},"MsgCompleteMigrateBucket"))),(0,n.kt)("h2",{id:"updatespprice"},"UpdateSPPrice"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#msgupdatespstorageprice"},"MsgUpdateSpStoragePrice"))),(0,n.kt)("h2",{id:"swapout"},"SwapOut"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#msgswapout"},"MsgSwapOut"))),(0,n.kt)("h2",{id:"completeswapout"},"CompleteSwapOut"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#msgcompleteswapout"},"MsgCompleteSwapOut"))),(0,n.kt)("h2",{id:"spexit"},"SPExit"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#msgstorageproviderexit"},"MsgStorageProviderExit"))),(0,n.kt)("h2",{id:"completespexit"},"CompleteSPExit"),(0,n.kt)("p",null,"The corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#msgcompletestorageproviderexit"},"MsgCompleteStorageProviderExit"))),(0,n.kt)("h2",{id:"gfsp-framework-signer-code"},"GfSp Framework Signer Code"),(0,n.kt)("p",null,"Signer module code implementation: ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/bnb-chain/greenfield-storage-provider/tree/master/modular/signer"},"Signer")))}d.isMDXComponent=!0}}]);