<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-api/bundle-service">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Bundle Service | BNB Greenfield</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.bnbchain.org/greenfield-docs/docs/api/bundle-service/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Bundle Service | BNB Greenfield"><meta data-rh="true" name="description" content="How to use bundle service to combine small objects."><meta data-rh="true" property="og:description" content="How to use bundle service to combine small objects."><meta data-rh="true" name="keywords" content="BNB Greenfield,NodeReal,Bundle,Bundle Service"><link data-rh="true" rel="icon" href="/greenfield-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.bnbchain.org/greenfield-docs/docs/api/bundle-service/"><link data-rh="true" rel="alternate" href="https://docs.bnbchain.org/greenfield-docs/docs/api/bundle-service/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.bnbchain.org/greenfield-docs/docs/api/bundle-service/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://3LF005YNGZ-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/greenfield-docs/blog/rss.xml" title="BNB Greenfield RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/greenfield-docs/blog/atom.xml" title="BNB Greenfield Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LSRFL0KHRR"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-LSRFL0KHRR",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="BNB Greenfield" href="/greenfield-docs/opensearch.xml"><link rel="stylesheet" href="/greenfield-docs/assets/css/styles.52c35f0a.css">
<link rel="preload" href="/greenfield-docs/assets/js/runtime~main.f7df5187.js" as="script">
<link rel="preload" href="/greenfield-docs/assets/js/main.0d93359b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/greenfield-docs/"><div class="navbar__logo"><img src="/greenfield-docs/img/logo.svg" alt="Greenfield Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/greenfield-docs/img/logo.svg" alt="Greenfield Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">BNB Greenfield</b></a><a class="navbar__item navbar__link" href="/greenfield-docs/docs/guide/introduction/overview/">Guide</a><a class="navbar__item navbar__link" href="/greenfield-docs/docs/tutorials/overview/">Tutorials</a><a class="navbar__item navbar__link" href="/greenfield-docs/docs/api/endpoints/">API &amp; SDK</a><a class="navbar__item navbar__link" href="/greenfield-docs/docs/release-notes/releaseNotes/">Releases</a><a class="navbar__item navbar__link" href="/greenfield-docs/docs/faq/greenfield-faqs/">FAQs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/bnb-chain/greenfield-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/greenfield-docs/docs/api/endpoints/">RPC Endpoints</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/greenfield-docs/docs/api/blockchain-cli/">Blockchain Command Line</a><button aria-label="Toggle the collapsible sidebar category &#x27;Blockchain Command Line&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/greenfield-docs/docs/api/blockchain-rest/">Blockchain API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Blockchain API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/greenfield-docs/docs/api/sp-cli/">Storage Command Line</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/greenfield-docs/docs/api/storage-provider-rest/">Storage Provider API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Storage Provider API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/greenfield-docs/docs/api/events/">Blockchain Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/greenfield-docs/docs/api/bundle-service/">Bundle Service</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/greenfield-docs/docs/sdks/">SDKs</a><button aria-label="Toggle the collapsible sidebar category &#x27;SDKs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_BDYx"><div class="docItemContainer_oq1c"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/greenfield-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Bundle Service</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Bundle Service</h1></header><div class="row"><div class="col col--12"><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>This blog post is contributed by <a href="https://docs.nodereal.io/docs/greenfield-bundle-service" target="_blank" rel="noopener noreferrer">NodeReal</a>.</p></div></div><p>With more and more developers joining BNB Greenfield ecosystem, many good practices utilizing decentralized storage
continue to emerge. On the other hand, sending small files to Greenfield is not an economic way. When small files are
sent, the information about the files (metadata) saved in the system can be bigger than the files themselves. This means
it costs more for both the users and Greenfield. For instance, imagine a user&#x27;s account wants to uploads a website to
Greenfield. If the files of the website are tiny but there are a lot of them, it leads to the same problem: too much
metadata and higher costs.</p><p>BNBChain has proposed the core protocol for the Greenfield bundle to solve this problem. You can find more details about <a href="https://github.com/bnb-chain/BEPs/pull/323" target="_blank" rel="noopener noreferrer">BEP-323</a>.
NodeReal is the first infrastructure provider to implement the bundling service. Bundling service provides a solution to
combine small files together into one big file before sending it to Greenfield. Thus, developers can can cut down unnecessary
costs while still get to each file in the big file as if they were separate.</p><p>NodeReal Bundling service is fully open sourced, developers can use NodeReal bundle service directly, while they can also
deploy their own bundle service if needed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bundle-format">Bundle Format<a class="hash-link" href="#bundle-format" title="Direct link to heading">​</a></h2><p>The bundle format specifies the structure and organization of the bundle that users create when packing files. This format
is designed to pack flat files; hierarchical directory structures, or folders, are not supported.</p><p>When dealing with a folder, we can simplify its structure by turning it into a series of individual files. As part of this
process, we rename each file to include the folder path. For example, a file originally named file.txt inside the nested
folders dira and dirb would be renamed to dira/dirb/file.txt. This approach allows us to maintain the organization of the
folder while conforming to the requirement for flat files in the bundle.</p><p>The bundle format is structured into several key components as follows:</p><ul><li>Version: This indicates the version number of the bundle protocol being used.</li><li>Meta Size: This specifies the size of the bundle&#x27;s metadata, allowing the construction of the bundle structure without the need to read the entire bundle.</li><li>Metadata: This section contains information about the files within the bundle. It facilitates the ability to access files randomly, which means you can jump directly to any file within the bundle without going through all the files.</li><li>Data: This portion represents the actual content and is comprised of all the files in bytes.</li></ul><p>For more details, you can refer to the <a href="https://github.com/bnb-chain/BEPs/pull/323" target="_blank" rel="noopener noreferrer">BEP-323</a> and <a href="https://github.com/bnb-chain/greenfield-bundle-sdk" target="_blank" rel="noopener noreferrer">Bundle-SDK</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bundle-service">Bundle Service<a class="hash-link" href="#bundle-service" title="Direct link to heading">​</a></h2><p>With the bundle format above, users now can pack their small objects into a bundle and upload the bundle file to Greenfield.
But users can not visit the objects in the bundle file conveniently.</p><p>The bundle service is designed to serve the users or dApps uploading a lot of small objects to Greenfield and provide an
indexing service for the objects in the bundle. Users can upload small objects to the bundle service and the bundle service
will pack the small files into a bundle and upload it to Greenfield, at the same time, the bundle service will also provide
a URL to visit each object in the bundle file.</p><p>The bundle service will upload the bundle file to the bucket that the user specified, so the user should grant the account
of the bundle service permission to upload files to the bucket. Meanwhile, the user should also grant the transaction fee
for the bundle service to upload objects to Greenfield.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="architecture">Architecture<a class="hash-link" href="#architecture" title="Direct link to heading">​</a></h3><p>The bundle service contains two main components: API service and Bundler.
<img loading="lazy" alt="bundle-architecture.png" src="/greenfield-docs/assets/images/bundle-1-0999f56da817f2a160d3643900ad7cca.png" width="2466" height="1052" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="api-service">API Service<a class="hash-link" href="#api-service" title="Direct link to heading">​</a></h4><p>The API service will serve users&#x27; requests like uploading an object, querying an object, etc.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="bundler">Bundler<a class="hash-link" href="#bundler" title="Direct link to heading">​</a></h4><p>The bundler will pack the objects that the user uploaded into a bundle file and upload it to a bucket in Greenfield.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="main-workflows">Main Workflows<a class="hash-link" href="#main-workflows" title="Direct link to heading">​</a></h3><p>It is important to understand that the Bundler service uploads bundled files to the user&#x27;s bucket, the user has absolute
control over the bundle files. This level of control allows users to manage and manipulate their bundled files as needed
effectively.</p><p>The bundle service utilizes its own account to send transactions and submit bundled files to Greenfield. Users are responsible
for covering the transaction fees, and they need to grant authorization to the bundler account to create new files under
their bucket. Therefore, it is essential to complete the necessary authorization before using the bundler service.</p><p>Greenfield can manage permissions for buckets and files. However, to keep the bundler service streamlined, complex permission
management is currently not available. The bundler service only supports public buckets, allowing only the bucket owner
to upload files. However, all users can access the files through the bundler service with no authorization.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="grant-permission">Grant Permission<a class="hash-link" href="#grant-permission" title="Direct link to heading">​</a></h4><p><img loading="lazy" alt="grant-permission.png" src="/greenfield-docs/assets/images/bundle-2-a4cebef62b666f3a0f3515914d617242.png" width="952" height="701" class="img_ev3q"></p><ul><li>Step 1: Before using the Bundle service, the user needs to create a bucket on Greenfield, and the visibility should be public. To create a bucket with the greenfield-go-sdk, use the following API. For a GUI option, you can use DCellar to create a new bucket.</li></ul><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Client</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CreateBucket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bucketName </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> primaryAddr </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CreateBucketOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>Step 2: To ensure optimal performance when uploading bundled files to Greenfield, the bundler service offers multiple operator addresses. The operator address is used to replace the user in uploading the bundled objects to Greenfield. Get the operator address for creating the bundled objects on Greenfield.</p></li><li><p>Step 3: Grant fee and permission to the operator address for creating bundled objects under the bucket. For the fee grant, you can only create a fee allowance for object creation.</p></li></ul><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Client</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GrantAllowance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> granteeAddr </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> allowance feegrant</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">FeeAllowanceI</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> txOption gnfdsdktypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TxOption</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// NewAllowedMsgAllowance creates new filtered fee allowance.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewAllowedMsgAllowance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">allowance FeeAllowanceI</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> allowedMsgs </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AllowedMsgAllowance</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>  For the permission grant, you can use the following APIs to grant permission only for object creation.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Client</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">PutBucketPolicy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bucketName </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> principalStr types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Principal</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">statements </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">permTypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Statement</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opt types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PutPolicyOption</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewPrincipalWithAccount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">principalAddr sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AccAddress</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Principal</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">actions </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">permTypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ActionType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> effect permTypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Effect</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resource </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NewStatementOptions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> permTypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Statement</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="upload-object">Upload Object<a class="hash-link" href="#upload-object" title="Direct link to heading">​</a></h4><p>The bundle will be frozen if any of the following conditions are met:</p><ul><li>The size of the bundle is equal to or greater than the MaxBundledSize, which has a default value of 1GB.</li><li>The number of objects in the current bundle is equal to or greater than the MaxBundledNumber, which has a default value of 1000.</li><li>The time interval since the creation of the bundle is equal to or greater than the MaxFinalizeTime, which has a default value of 24 hours.</li></ul><p>Users can also define their own rules for MaxBundledSize , MaxBundledNumber , and MaxFinalizeTime , but the values should not exceed the default ones.</p><p>In this mode, when the previous bundle is frozen, if there are any new files uploaded, the bundler service will automatically create a new bundle for the user, eliminating the need for any additional user intervention. The bundles created by the bundler service follow the naming format of {bundle<em>prefix}</em>{bundle_nonce} . The bundle_prefix is bundle by default, and  bundle_nonce is the number of bundles created in the bucket.</p><p><img loading="lazy" alt="upload-object1.png" src="/greenfield-docs/assets/images/bundle-3-e8e24900f5082590e5651b48209724be.png" width="913" height="901" class="img_ev3q"></p><p>In addition, users have the option to fully specify the lifecycle of a bundle by creating a new bundle using the &quot;create bundle&quot; API and then requesting to submit the bundle to Greenfield through the &quot;seal bundle&quot; API. It is important to note that the time from bundle creation to sealing should not exceed the DeaultMaxBundledTime of 24 hours. If this time limit is exceeded, the bundle service will automatically set the bundle as expired and the user can not finalize the bundle anymore.</p><p><img loading="lazy" alt="upload-object2.png" src="/greenfield-docs/assets/images/bundle-4-0dd4da927dd4f58798a938dd109b704f.png" width="671" height="700" class="img_ev3q"></p><p>The bundler service is primarily designed to address the storage performance and efficiency issues associated with small files. Therefore, it is important to note that the file size uploaded to the bundle service should not exceed 16 MB. Any file exceeding this limit will be rejected by the bundle service.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="upload-bundle">Upload Bundle<a class="hash-link" href="#upload-bundle" title="Direct link to heading">​</a></h4><p>Since users may want to upload files at the same time like uploading a website, the bundle service allows users to upload a valid bundle.
You can use the <a href="https://github.com/bnb-chain/greenfield-bundle-sdk/tree/master?tab=readme-ov-file#command-line-tool" target="_blank" rel="noopener noreferrer">bundle commandline tool</a> to easily combine small objects into a bundle.</p><p>The bundle service will validate the uploaded bundle, if the bundle is invalid, the request will be rejected.</p><p>For the valid bundle, it will index all the files in the bundle so the user can visit the files in the bundle like the objects uploaded via UploadObject API.</p><p>Unlike the UploadObject API, the user must specify the bundle name when uploading a bundle and the user are not allowed to upload objects to this bundle any longer. The bundle will be marked as Finalized and it will be uploaded to Greenfield by the bundle service.</p><p><img loading="lazy" alt="upload-bundle.png" src="/greenfield-docs/assets/images/bundle-5-29bf3b7a07035c61ef4cbecc65215096.png" width="672" height="320" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-object">Query Object<a class="hash-link" href="#query-object" title="Direct link to heading">​</a></h4><p>The Bundle service stores index information for uploaded objects. It tracks the bundle and its metadata, making it easy to locate and index files bundled on Greenfield. The service also caches frequently accessed data to improve request performance.</p><ul><li>When the bundler service has the file saved, the bundler service can respond to the request immediately.</li><li>If only the index information is available, the bundle service retrieves the file from Greenfield and returns it to the user.</li><li>If the index is missing, the service attempts to rebuild it from Greenfield and then retrieves and returns the file.</li></ul><p><img loading="lazy" alt="query-object.png" src="/greenfield-docs/assets/images/bundle-6-f4c8727c6c7918f0cadabc376aee2a19.png" width="1032" height="683" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="apis">APIs<a class="hash-link" href="#apis" title="Direct link to heading">​</a></h3><p>The Bundle Service Server API provides several endpoints for managing and interacting with bundles. Here&#x27;s a brief overview:</p><ul><li><strong>Upload a single object to a bundle (POST /uploadObject):</strong> This endpoint allows users to upload a single object to a bundle, requiring details like bucket name, file name, and etc.</li><li><strong>Upload a bundle (POST /uploadBundle):</strong> This endpoint allows users to upload a bundle of objects, requiring details like bucket name, bundle name, and etc.</li><li><strong>Retrieve an object as a file from a bundle (GET /view/{bucketName}/{bundleName}/{objectName}):</strong> This endpoint fetches a specific object from a given bundle and returns it as a file.</li><li><strong>Download an object as a file from a bundle (GET /download/{bucketName}/{bundleName}/{objectName}):</strong> This endpoint allows users to download a specific object from a given bundle and returns it as a file.</li><li><strong>Query bundle information (GET /queryBundle/{bucketName}/{bundleName}):</strong> This endpoint queries a specific object from a given bundle and returns its related information.</li><li><strong>Query bundling bundle information of a bucket (GET /queryBundlingBundle/{bucketName}):</strong> This endpoint queries the bundling bundle information of a given bucket.</li><li><strong>Start a New Bundle (POST /createBundle):</strong> This endpoint initiates a new bundle, requiring details like bucket name and bundle name.</li><li><strong>Finalize an Existing Bundle (POST /finalizeBundle):</strong> This endpoint completes the lifecycle of an existing bundle, requiring the bundle name for authorization.</li><li><strong>Delete an Existing Bundle (POST /deleteBundle):</strong> This endpoint deletes an existing bundle after object deletion on Greenfield.</li><li><strong>Get Bundler Account for a User (POST /bundlerAccount/{userAddress}):</strong> This endpoint returns the bundler account for a given user.</li><li><strong>Set New Bundling Rules (POST /setBundleRule):</strong> This endpoint allows users to set new rules or replace old rules for bundling, including constraints like maximum size and number of files.</li></ul><p>For more detailed information about each endpoint, including required parameters and response formats, please refer to the swagger.yaml file in <a href="https://github.com/node-real/greenfield-bundle-service" target="_blank" rel="noopener noreferrer">https://github.com/node-real/greenfield-bundle-service</a>.</p><p>For detailed usage cases, you can refer to the e2e test cases in <a href="https://github.com/node-real/greenfield-bundle-service/tree/main/e2e" target="_blank" rel="noopener noreferrer">https://github.com/node-real/greenfield-bundle-service/tree/main/e2e</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="endpoints">Endpoints<a class="hash-link" href="#endpoints" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="greenfield-testnet">Greenfield Testnet<a class="hash-link" href="#greenfield-testnet" title="Direct link to heading">​</a></h4><p>Using the testnet&#x27;s bundle service, the bundle file will be uploaded to the Greenfield testnet. Endpoint:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://gnfd-testnet-bundle.nodereal.io</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="greenfield-mainnet">Greenfield Mainnet<a class="hash-link" href="#greenfield-mainnet" title="Direct link to heading">​</a></h4><p>Coming soon...</p></div></div></div><div class="col col--12"><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/bnb-chain/greenfield-docs/blob/main/docs/api/bundle-service.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></div></article><div class="col col--12"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/greenfield-docs/docs/api/events/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Blockchain Events</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/greenfield-docs/docs/sdks/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SDKs</div></a></nav></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#bundle-format" class="table-of-contents__link toc-highlight">Bundle Format</a></li><li><a href="#bundle-service" class="table-of-contents__link toc-highlight">Bundle Service</a><ul><li><a href="#architecture" class="table-of-contents__link toc-highlight">Architecture</a></li><li><a href="#main-workflows" class="table-of-contents__link toc-highlight">Main Workflows</a></li><li><a href="#apis" class="table-of-contents__link toc-highlight">APIs</a></li><li><a href="#endpoints" class="table-of-contents__link toc-highlight">Endpoints</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/greenfield-docs/assets/js/runtime~main.f7df5187.js"></script>
<script src="/greenfield-docs/assets/js/main.0d93359b.js"></script>
</body>
</html>