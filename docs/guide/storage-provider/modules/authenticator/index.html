<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-guide/storage-provider/modules/authenticator">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Authenticator | BNB Greenfield</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.bnbchain.org/greenfield-docs/docs/guide/storage-provider/modules/authenticator/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="decentralized storage, blockchain storage solution"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Authenticator | BNB Greenfield"><meta data-rh="true" name="description" content="The Authenticator module is responsible for validating users&#x27; authentication information and verifying their permissions in certain scenarios."><meta data-rh="true" property="og:description" content="The Authenticator module is responsible for validating users&#x27; authentication information and verifying their permissions in certain scenarios."><link data-rh="true" rel="icon" href="/greenfield-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.bnbchain.org/greenfield-docs/docs/guide/storage-provider/modules/authenticator/"><link data-rh="true" rel="alternate" href="https://docs.bnbchain.org/greenfield-docs/docs/guide/storage-provider/modules/authenticator/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.bnbchain.org/greenfield-docs/docs/guide/storage-provider/modules/authenticator/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://3LF005YNGZ-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/greenfield-docs/blog/rss.xml" title="BNB Greenfield RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/greenfield-docs/blog/atom.xml" title="BNB Greenfield Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LSRFL0KHRR"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-LSRFL0KHRR",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="BNB Greenfield" href="/greenfield-docs/opensearch.xml"><link rel="stylesheet" href="/greenfield-docs/assets/css/styles.52c35f0a.css">
<link rel="preload" href="/greenfield-docs/assets/js/runtime~main.42e2b027.js" as="script">
<link rel="preload" href="/greenfield-docs/assets/js/main.f34e02b4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/greenfield-docs/"><div class="navbar__logo"><img src="/greenfield-docs/img/logo.svg" alt="Greenfield Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/greenfield-docs/img/logo.svg" alt="Greenfield Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">BNB Greenfield</b></a><a class="navbar__item navbar__link" href="/greenfield-docs/docs/guide/introduction/overview/">Guide</a><a class="navbar__item navbar__link" href="/greenfield-docs/docs/tutorials/overview/">Tutorials</a><a class="navbar__item navbar__link" href="/greenfield-docs/docs/api/endpoints/">API &amp; SDK</a><a class="navbar__item navbar__link" href="/greenfield-docs/docs/release-notes/releaseNotes/">Releases</a><a class="navbar__item navbar__link" href="/greenfield-docs/docs/faq/greenfield-faqs/">FAQs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/bnb-chain/greenfield-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/greenfield-docs/docs/guide/home/">Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/greenfield-docs/docs/guide/getting-started/overview/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/greenfield-docs/docs/guide/core-concept/accounts/">Core Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/greenfield-docs/docs/guide/greenfield-blockchain/overview/">Greenfield Blockchain</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/greenfield-docs/docs/guide/storage-provider/introduction/overview/">Storage Provider</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/introduction/overview/">Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/gateway/">Modules</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/gateway/">Gateway</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/approver/">Approver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/authenticator/">Authenticator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/uploader/">Uploader</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/downloader/">Downloader</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/signer/">Signer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/manager/">Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/taskexecutor/">TaskExecutor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/receiver/">Receiver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/metadata/">Metadata</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/blocksyncer/">Block Syncer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/spdb/">SPDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/piece-store/">Piece Store</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/redundancy/">Redundancy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/modules/bsdb/">BSDB</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/greenfield-docs/docs/guide/storage-provider/run-book/compile-dependences/">Run Storage Provider</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/greenfield-docs/docs/contribute/">Contribute</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/bnb-chain/greenfield-whitepaper" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK">Whitepaper<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_BDYx"><div class="docItemContainer_oq1c"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/greenfield-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Storage Provider</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Modules</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Authenticator</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><div class="row"><div class="col col--12"><h1>Authenticator</h1><p>The Authenticator module is responsible for validating users&#x27; authentication information and verifying their permissions in certain scenarios.
For most requests sent to the SP gateway, they must successfully pass the authentication verification process.</p><p>We currently abstract SP as the GfSp framework, which provides users with customizable capabilities to meet their specific requirements. Authenticator module provides an abstract interface, which is called <code>Authenticator</code>, as follows:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Authenticator is an abstract interface to verify users authentication.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Authenticator </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Modular</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// VerifyAuthentication verifies the operator authentication.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">VerifyAuthentication</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> auth AuthOpType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> account</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bucket</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> object </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// GetAuthKeyV2 can check if the given account/domain/public_key was registered in this system.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetAuthKeyV2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> account </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> domain </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> publicKey </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">spdb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">OffChainAuthKeyV2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ListAuthKeysV2 can list user public keys</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">ListAuthKeysV2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> account </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> domain </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// DeleteAuthKeysV2 can delete user public keys</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">DeleteAuthKeysV2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> account </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> domain </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> publicKeys </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// UpdateUserPublicKeyV2 registered the user public key once the dApp or client generates the EDDSA key pairs.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">UpdateUserPublicKeyV2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> account </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> domain </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> publicKey </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expiryDate </span><span class="token builtin">int64</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// VerifyGNFD2EddsaSignature verifies the signature signed by user&#x27;s EDDSA private key.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">VerifyGNFD2EddsaSignature</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> account </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> domain </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> publicKey </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> offChainSig </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> realMsgToSign </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpType defines the operator type used to authentication verification.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> AuthOpType </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpTypeUnKnown defines the default value of AuthOpType</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpTypeUnKnown AuthOpType </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">iota</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpAskCreateBucketApproval defines the AskCreateBucketApproval operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpAskCreateBucketApproval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpAskMigrateBucketApproval defines the AskMigrateBucketApproval operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpAskMigrateBucketApproval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpAskCreateObjectApproval defines the AskCreateObjectApproval operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpAskCreateObjectApproval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpTypeGetChallengePieceInfo defines the GetChallengePieceInfo operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpTypeGetChallengePieceInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpTypePutObject defines the PutObject operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpTypePutObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpTypeGetObject defines the GetObject operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpTypeGetObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpTypeGetUploadingState defines the GetUploadingState operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpTypeGetUploadingState</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpTypeGetBucketQuota defines the GetBucketQuota operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpTypeGetBucketQuota</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpTypeListBucketReadRecord defines the ListBucketReadRecord operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpTypeListBucketReadRecord</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpTypeGetRecoveryPiece defines the GetRecoveryPiece operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpTypeGetRecoveryPiece</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpTypeQueryBucketMigrationProgress defines the QueryBucketMigrationProgress operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpTypeQueryBucketMigrationProgress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpTypeAgentPutObject defines the agent PutObject operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpTypeAgentPutObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// AuthOpTypeAgentUpdateObject the agent UpdateObject operator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthOpTypeAgentUpdateObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Authenticator interface inherits <a href="/greenfield-docs/docs/guide/storage-provider/modules/common/lifecycle_modular/#modular-interface">Modular interface</a>, so Authenticator module can be managed by lifecycle and resource manager.</p><p>You can overwrite <code>VerifyAuthentication</code> to implement your own authentication mode by different AuthOpType. This is the most basic authentication.</p><h1>Greenfield Storage Provider Off-Chain Authentication</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="abstract">Abstract<a class="hash-link" href="#abstract" title="Direct link to heading">​</a></h2><p>This document outlines an off-chain authentication specification for greenfield storage providers (SPs) and clients. The specification includes a full functional workflow and a reference implementation, making it easy for any application integrating with greenfield SPs to build an off-chain authentication mechanism.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="motivation">Motivation<a class="hash-link" href="#motivation" title="Direct link to heading">​</a></h2><p>Applications based on the greenfield chain often need to interact with multiple greenfield SPs, which are off-chain services that require users to use Ethereum-compatible accounts to represent their identities.</p><p>For most interactions between applications and SPs, users&#x27; identities are required. Typically, applications can use message signing via account private keys to authenticate users, as long as they have access to their private keys. However, for browser-based applications, accessing the end users&#x27; private keys directly is not possible, making it necessary to prompt users to sign messages for each off-chain request between applications and SPs. This results in a poor user experience.</p><p>This document describes a workflow to address this problem.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="workflow">WorkFlow<a class="hash-link" href="#workflow" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="overall-workflow">Overall workflow<a class="hash-link" href="#overall-workflow" title="Direct link to heading">​</a></h3><p><img loading="lazy" alt="auth-workflow" src="/greenfield-docs/assets/images/015-Auth-Overview-414aa981090558e1f2ff647757e7c940.png" width="722" height="838" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1---generate-eddsa-key-pairs-in-apps">Step 1 - Generate EdDSA key pairs in Apps<a class="hash-link" href="#step-1---generate-eddsa-key-pairs-in-apps" title="Direct link to heading">​</a></h3><p>Applications can design how to generate EdDSA key pairs themselves, and SPs do not have any restrictions on it.</p><p>Here is one example.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports operator" style="color:#393A34">*</span><span class="token imports"> </span><span class="token imports keyword module" style="color:#00009f">as</span><span class="token imports"> ed25519</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@noble/curves/ed25519&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generateKeys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> privateKey </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ed25519</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">randomPrivateKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// generate private key via crypto.getRandomValues</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> publicKey </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ed25519</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getPublicKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">privateKey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// get publick key from private key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> privateKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> publicKey </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2---register-eddsa-public-key-in-sps">Step 2 - Register EdDSA public key in SPs<a class="hash-link" href="#step-2---register-eddsa-public-key-in-sps" title="Direct link to heading">​</a></h3><p>To register an account public key into a certain SP, you can invoke <a href="/greenfield-docs/docs/api/storage-provider-rest/update_key/">SP API &quot;update<!-- -->_<!-- -->key&quot;</a>.</p><p>Here is an example. Suppose that</p><ol><li>The <strong>user account address</strong> is <code>0x3d0a49B091ABF8940AD742c0139416cEB30CdEe0</code></li><li>The <strong>app domain</strong> is <code>https://greenfield_app1.domain.com</code></li><li>The <strong>SP operator address</strong> is <code>0x70d1983A9A76C8d5d80c4cC13A801dc570890819</code></li><li>The <strong>EdDSA<!-- -->_<!-- -->public<!-- -->_<!-- -->K</strong> is <code>4db642fe6bc2ceda2e002feb8d78dfbcb2879d8fe28e84e02b7a940bc0440083</code></li><li>The <strong>expiry time</strong> for this <code>EdDSA_public_K</code> is <code>2023-04-28T16:25:24Z</code>. The expiry time indicates the expiry time of this <code>EdDSA_public_K</code> , which should be a future time and within <strong>7 days.</strong></li></ol><p>The app will put above information into a text message:</p><div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://greenfield_app1.domain.com wants you to sign in with your BNB Greenfield account:\n0x3d0a49B091ABF8940AD742c0139416cEB30CdEe0\n\nRegister your identity public key 4db642fe6bc2ceda2e002feb8d78dfbcb2879d8fe28e84e02b7a940bc0440083\n\nURI: https://greenfield_app1.domain.com\nVersion: 1\nChain ID: 5600\nIssued At: 2023-04-24T16:25:24Z\nExpiration Time: 2023-04-28T16:25:24Z</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We denote this text message as <code>M</code></p><p>and request user to sign and get the signature<code>S</code>:</p><div align="left"><img loading="lazy" src="https://raw.githubusercontent.com/bnb-chain/greenfield-docs/main/static/asset/015-Auth-Update-Key-Metamask.png" width="500" height="100" class="img_ev3q"></div><p>Finally, the app invokes <a href="/greenfield-docs/docs/api/storage-provider-rest/update_key/">SP API &quot;update<!-- -->_<!-- -->key&quot;</a> by putting <code>S</code> into http Authorization header. The following is an example:</p><div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl --location --request POST &#x27;https://${SP_API_ADDRESS}/auth/update_key&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;Origin: https://greenfield_app1.domain.com&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;X-Gnfd-App-Domain: https://greenfield_app1.domain.com&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;x-Gnfd-User-Address: 0x3d0a49B091ABF8940AD742c0139416cEB30CdEe0&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;X-Gnfd-App-Reg-Public-Key: 4db642fe6bc2ceda2e002feb8d78dfbcb2879d8fe28e84e02b7a940bc0440083&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;X-Gnfd-Expiry-Timestamp: 2023-04-28T16:25:24Z&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;Authorization: GNFD1-ETH-PERSONAL_SIGN,SignedMsg=https://greenfield_app1.domain.com wants you to sign in with your BNB Greenfield account:\n0x3d0a49B091ABF8940AD742c0139416cEB30CdEe0\n\nRegister your identity public key 4db642fe6bc2ceda2e002feb8d78dfbcb2879d8fe28e84e02b7a940bc0440083\n\nURI: https://greenfield_app1.domain.com\nVersion: 1\nChain ID: 5600\nIssued At: 2023-04-24T16:25:24Z\nExpiration Time: 2023-04-28T16:25:24Z&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once the response code returns 200, the user&#x27;s public is successfully registered the given SP server and ready to use.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3---use-eddsa-seed-to-sign-request-and-verification">Step 3 - Use EdDSA seed to sign request and verification<a class="hash-link" href="#step-3---use-eddsa-seed-to-sign-request-and-verification" title="Direct link to heading">​</a></h3><p>In Step1 &amp; Step2, we generated EdDSA keys and registered them into SP. In Step3, we can use <code>EdDSA_private_K</code> to sign request when an app invokes a certain SP API.</p><p>To sign a request, the app needs to calculate the signedMsg before doing the actual signing.<br>
<!-- -->See <a href="/greenfield-docs/docs/api/storage-provider-rest/#the-step-of-generating-authorization-header">calculate the signedMsg</a></p><p>And the following is an example</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Authorization </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> auth_type + </span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token plain"> + Signature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string-to-sign </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> crypto.Keccak256</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">canonical</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Signature </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> privateKey.EdDSA-Sign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">string-to-sign</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Authorization: GNFD2-EDDSA, </span><span class="token assign-left variable" style="color:#36acaa">Signature</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">9dac5eeaca7fb65265528773e11819cb9980cd9be68eebe8a10dea643f265c8302887f014eb78c3249c05d1038e81f93b4253a298cd9edf18982345c394ba9fb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also refer to the sample code to generate the off-chain-auth signature (EdDSA)  at:<br>
<a href="https://github.com/bnb-chain/greenfield-go-sdk/blob/a21d3b5eb75a211266105ea78ad1c76fcdc87c4d/client/api_client.go#L675C2-L685C3" target="_blank" rel="noopener noreferrer">Sample Code to generate EdDSA Signaure For Greenfied GNFD2-EdDSA AuthType</a></p><p>For example, if a user clicks the &quot;download&quot; button in an app to download a private object they own, this will invoke the SP getObject API.
The <code>EdDSA_M</code> could be defined as <code>Invoke_GetObject_1682407345000</code>, and the <code>EdDSA_S</code> would be <code>a48fff140b148369a108611502acff919720b5493aa36ba0886d8d73634ee20404963b847104d06aa822cf904741aff70ede4ba7d70fa8808c3206d4c93be623</code>.</p><p>To combine <code>EdDSA_M</code> and <code>EdDSA_S</code>, the app should include them in the Authorization header when invoking the GetObject API:</p><div class="language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl --location &#x27;https://${SP_API_ADDRESS}/${bucket_name}/${object_name}&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;authorization: GNFD2-EDDSA,Signature=a48fff140b148369a108611502acff919720b5493aa36ba0886d8d73634ee20404963b847104d06aa822cf904741aff70ede4ba7d70fa8808c3206d4c93be623&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;X-Gnfd-User-Address: 0x3d0a49B091ABF8940AD742c0139416cEB30CdEe0&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;X-Gnfd-App-Domain: https://greenfield_app1.domain.com&#x27; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;X-Gnfd-App-Reg-Public-Key: e0d61609201e9cece55e8999a40a74f5119003b1d49fad32882fa50547c4bf90&#x27; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By including the signed message and signature in the Authorization header, the app can authenticate the request with the SP servers. The SP servers can then verify the signature using the EdDSA_public_K registered in Step 2.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4---manage-eddsa-key-pairs">Step 4 - Manage EdDSA key pairs<a class="hash-link" href="#step-4---manage-eddsa-key-pairs" title="Direct link to heading">​</a></h3><p>Although we defined an expiry date for registered <code>EdDSA_public_K</code>, users might want to know how many EdDSA keys they are currently using and might want to delete them for security concerns.</p><p>To list a user&#x27;s registered EdDSA account public keys in an SP, apps can invoke <a href="/greenfield-docs/docs/api/storage-provider-rest/list_key/">SP API &quot;list<!-- -->_<!-- -->key&quot;</a>.
To delete a user&#x27;s registered EdDSA account public key in an SP, apps can invoke  <a href="/greenfield-docs/docs/api/storage-provider-rest/delete_key/">SP API &quot;delete<!-- -->_<!-- -->key&quot;</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="auth-api-specification">Auth API Specification<a class="hash-link" href="#auth-api-specification" title="Direct link to heading">​</a></h3><p>See <a href="/greenfield-docs/docs/api/storage-provider-rest/">SP Auth Rest API Doc</a></p></div></div></div><div class="col col--12"><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/bnb-chain/greenfield-docs/blob/main/docs/guide/storage-provider/modules/authenticator.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></div></article><div class="col col--12"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/greenfield-docs/docs/guide/storage-provider/modules/approver/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Approver</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/greenfield-docs/docs/guide/storage-provider/modules/uploader/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Uploader</div></a></nav></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#abstract" class="table-of-contents__link toc-highlight">Abstract</a></li><li><a href="#motivation" class="table-of-contents__link toc-highlight">Motivation</a></li><li><a href="#workflow" class="table-of-contents__link toc-highlight">WorkFlow</a><ul><li><a href="#overall-workflow" class="table-of-contents__link toc-highlight">Overall workflow</a></li><li><a href="#step-1---generate-eddsa-key-pairs-in-apps" class="table-of-contents__link toc-highlight">Step 1 - Generate EdDSA key pairs in Apps</a></li><li><a href="#step-2---register-eddsa-public-key-in-sps" class="table-of-contents__link toc-highlight">Step 2 - Register EdDSA public key in SPs</a></li><li><a href="#step-3---use-eddsa-seed-to-sign-request-and-verification" class="table-of-contents__link toc-highlight">Step 3 - Use EdDSA seed to sign request and verification</a></li><li><a href="#step-4---manage-eddsa-key-pairs" class="table-of-contents__link toc-highlight">Step 4 - Manage EdDSA key pairs</a></li><li><a href="#auth-api-specification" class="table-of-contents__link toc-highlight">Auth API Specification</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/greenfield-docs/assets/js/runtime~main.42e2b027.js"></script>
<script src="/greenfield-docs/assets/js/main.f34e02b4.js"></script>
</body>
</html>